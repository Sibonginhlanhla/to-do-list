import"./styles.css";import{renderItems,addItem,addProject,Item}from"./list";let myProjects=[];function updateLocalStorage(){localStorage.setItem("myProjects",JSON.stringify(myProjects))}function reloadFromStorage(){const e=localStorage.getItem("myProjects");e&&(myProjects=JSON.parse(e).map((e=>({name:e.name,arr:e.arr.map((e=>new Item(e.title,e.description,e.dueDate,e.priority,e.checked)))}))))}function createTable(e){e.innerHTML="\n        <caption></caption>\n        <tr>\n            <th>Title</th>\n            <th>Description</th>\n            <th>Due Date</th>\n            <th>Priority</th>\n            <th>Progress</th>\n            <th>Remove</th>\n        </tr>\n    "}function renderProjectTable(e){content.textContent="";const t=document.createElement("table");createTable(t),content.appendChild(t);const o=t.querySelector("caption");o.textContent=e,o.style.color="white",o.style.fontSize="2rem";const r=myProjects.find((t=>t.name===e));r&&r.arr.forEach((e=>renderItems(e,t)))}function refreshProjectOptions(){[document.querySelector("#project"),document.querySelector("#projectSelect")].forEach((e=>{e.innerHTML="",myProjects.forEach((t=>{const o=new Option(t.name,t.name);e.appendChild(o)}))}))}const content=document.querySelector("#content"),buttonDiv=document.querySelector("#add"),stored=localStorage.getItem("myProjects");if(stored){const e=JSON.parse(stored);myProjects=e.map((e=>({name:e.name,arr:e.arr.map((e=>new Item(e.title,e.description,e.dueDate,e.priority,e.checked)))})))}else myProjects=[{name:"Default",arr:[new Item("Welcome!","Add your tasks here.","","High",!1)]}],updateLocalStorage();["New Project","New Item","Select Project","View Projects"].forEach(((e,t)=>{const o=document.createElement("button");o.textContent=e,buttonDiv.appendChild(o),0===t&&(o.onclick=()=>newProjectDialog.showModal()),1===t&&(o.onclick=()=>newItemDialog.showModal()),2===t&&(o.onclick=()=>selectProjectDialog.showModal()),3===t&&(o.onclick=()=>{content.textContent="";const e=document.createElement("h1");e.textContent="My Projects",content.appendChild(e),myProjects.forEach(((e,t)=>{const r=document.createElement("div");r.className="project-card",r.innerHTML=`\n                <h2>${e.name}</h2>\n                <p>Items: ${e.arr.length}</p>\n                <ul>\n                    ${e.arr.slice(0,3).map((e=>`<li>${e.title} - ${e.dueDate}</li>`)).join("")}\n                </ul>\n                <button class="delete">Delete</button>\n            `,r.querySelector(".delete").onclick=()=>{confirm(`Delete project '${e.name}'?`)&&(myProjects.splice(t,1),updateLocalStorage(),refreshProjectOptions(),o.click())},content.appendChild(r)}))})}));const newItemDialog=document.querySelector("#newItemDialog"),newProjectDialog=document.querySelector("#newProjectDialog"),selectProjectDialog=document.querySelector("#selectProjectDialog"),confirmProjectBtn=document.querySelector("#confirmProjectBtn");confirmProjectBtn.onclick=()=>{const e=document.querySelector("#projectName").value.trim();return e?myProjects.find((t=>t.name===e))?alert("Project exists."):(addProject(e),myProjects.push({name:e,arr:[]}),updateLocalStorage(),refreshProjectOptions(),void newProjectDialog.close()):alert("Enter a valid name.")};const confirmBtn=document.querySelector("#confirmBtn");confirmBtn.onclick=()=>{const e=document.querySelector("#title").value,t=document.querySelector("#desc").value,o=document.querySelector("#date").value,r=document.querySelector("#priority").value,c=document.querySelector("#project").value,n=new Item(e,t,o,r),a=myProjects.find((e=>e.name===c));a&&(a.arr.push(n),updateLocalStorage(),newItemDialog.close())};const confirmSelectBtn=document.querySelector("#confirmSelectBtn");confirmSelectBtn.onclick=()=>{renderProjectTable(document.querySelector("#projectSelect").value),selectProjectDialog.close()},refreshProjectOptions(),renderProjectTable("Default");export{updateLocalStorage,reloadFromStorage};